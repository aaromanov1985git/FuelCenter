# üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç –≤–µ–±-–ø—Ä–æ–µ–∫—Ç–∞ GSM Converter

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2024  
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** 1.0.0  
**–°—Ç–µ–∫:** FastAPI (Python) + React (JavaScript) + PostgreSQL + Redis

---

## üîç –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –∑—Ä–µ–ª–æ—Å—Ç—å:** ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ—Ä–∞–±–æ—Ç–∫–∏**  
**–¢–µ—Å—Ç–æ–≤–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞:** ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, —Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è**

### –†–µ–∑—é–º–µ

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å React frontend. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (Redis, Prometheus, Docker), –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∑–∞—è–≤–ª–µ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ NestJS/TypeScript. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:

- ‚úÖ **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:** –•–æ—Ä–æ—à–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞, –Ω–∞–ª–∏—á–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚ö†Ô∏è **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–µ–ª—ã:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –Ω–µ—Ç WebSocket —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ TypeScript –Ω–∞ frontend
- üî¥ **–ë–ª–æ–∫–µ—Ä—ã –¥–ª—è production:** –ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ bounded contexts, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ realtime-–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏, –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ best practices

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ**

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–º–æ–Ω–æ–ª–∏—Ç–Ω–æ–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**, –∞ –Ω–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã (`backend/app/routers/`) –∏ —Å–µ—Ä–≤–∏—Å—ã (`backend/app/services/`) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –í—Å–µ 24 —Ä–æ—É—Ç–µ—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –≤ `main.py` –±–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- –ù–µ—Ç —á–µ—Ç–∫–∏—Ö bounded contexts (Transactions, Vehicles, Devices, Trips, Reports, Realtime, Notifications, Platform Adapters, Device Config, Servers)
- –ü—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ —á–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç—ã
- –û–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –∏–∑–æ–ª—è—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏
- –ù–µ—Ç API Gateway –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (–∫—Ä–∏—Ç–∏—á–Ω–æ):**
   ```
   services/
   ‚îú‚îÄ‚îÄ api-gateway/          # NestJS, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   ‚îú‚îÄ‚îÄ auth-service/          # NestJS, JWT, Passport, refresh tokens
   ‚îú‚îÄ‚îÄ vehicles-service/      # NestJS, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¢–°
   ‚îú‚îÄ‚îÄ devices-service/       # NestJS, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
   ‚îú‚îÄ‚îÄ trips-service/         # NestJS, –ø–æ–µ–∑–¥–∫–∏ –∏ –º–∞—Ä—à—Ä—É—Ç—ã
   ‚îú‚îÄ‚îÄ reports-service/       # NestJS, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
   ‚îú‚îÄ‚îÄ realtime-service/      # NestJS + Socket.io, WebSocket
   ‚îú‚îÄ‚îÄ notifications-service/ # NestJS, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Email, Push, Telegram)
   ‚îú‚îÄ‚îÄ platform-adapters/    # NestJS, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ API
   ‚îú‚îÄ‚îÄ device-config/         # NestJS, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
   ‚îî‚îÄ‚îÄ servers-service/       # NestJS, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
   ```

2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ bounded contexts:**
   - **Transactions Domain:** `transactions`, `fuel_cards`, `gas_stations`, `fuel_types`
   - **Vehicles Domain:** `vehicles`, `organizations`
   - **Notifications Domain:** `notifications`, `system_settings`
   - **Integration Domain:** `ppr_api`, `onec_integration`, `providers`
   - **Analytics Domain:** `dashboard`, `fuel_card_analysis`

3. **–ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
   - –§–∞–∑–∞ 1: –í—ã–¥–µ–ª–∏—Ç—å Auth Service (JWT, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
   - –§–∞–∑–∞ 2: –í—ã–¥–µ–ª–∏—Ç—å Notifications Service (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
   - –§–∞–∑–∞ 3: –í—ã–¥–µ–ª–∏—Ç—å Platform Adapters Service (–≤–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
   - –§–∞–∑–∞ 4: –†–∞–∑–¥–µ–ª–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã

4. **Database per service:**
   - –ö–∞–∂–¥—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–≤–æ—é –ë–î –∏–ª–∏ —Å—Ö–µ–º—É
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
   - –í–Ω–µ–¥—Ä–∏—Ç—å Saga pattern –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

---

### 2. API Gateway –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

–í –ø—Ä–æ–µ–∫—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π API Gateway. –í—Å–µ —Ä–æ—É—Ç–µ—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ `main.py`.

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ –Ω–µ Gateway
- –ù–µ—Ç –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —Å–µ—Ä–≤–∏—Å–∞–º
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è API –Ω–∞ —É—Ä–æ–≤–Ω–µ Gateway

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–í–Ω–µ–¥—Ä–∏—Ç—å NestJS API Gateway:**
   ```typescript
   // api-gateway/src/app.module.ts
   @Module({
     imports: [
       HttpModule,
       ClientsModule.register([
         { name: 'AUTH_SERVICE', transport: Transport.TCP, options: { port: 3001 } },
         { name: 'VEHICLES_SERVICE', transport: Transport.TCP, options: { port: 3002 } },
         // ...
       ]),
     ],
   })
   ```

2. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π rate limiting:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ rate limiting
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å sliding window algorithm

3. **–ê–≥—Ä–µ–≥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DataLoader pattern –¥–ª—è batch-–∑–∞–ø—Ä–æ—Å–æ–≤
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GraphQL Federation –∏–ª–∏ REST aggregation endpoints

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Gateway:**
   - –í–∞–ª–∏–¥–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ Gateway
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (RBAC) –ø–µ—Ä–µ–¥ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å correlation ID

5. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API:**
   - `/api/v1/`, `/api/v2/` –Ω–∞ —É—Ä–æ–≤–Ω–µ Gateway
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - Deprecation policy –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π

---

### 3. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π**

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω—ã –≤ `backend/app/auth.py`. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è httpOnly cookies –∏ Authorization header.

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ bcrypt –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ httpOnly cookies –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ `get_current_user`
- ‚úÖ –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (admin, superuser)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç refresh token –º–µ—Ö–∞–Ω–∏–∑–º–∞ (—Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ 30 –º–∏–Ω—É—Ç)
- ‚ùå –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage –Ω–∞ frontend (—Ä–∏—Å–∫ XSS)
- ‚ùå –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç–∑—ã–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ (blacklist)
- ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç scope-based –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ role-based)
- ‚ùå –ù–µ—Ç rate limiting –¥–ª—è auth endpoints (—Ç–æ–ª—å–∫–æ –æ–±—â–∏–π)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å refresh token flow:**
   ```typescript
   // auth-service/src/auth.service.ts
   async login(credentials: LoginDto) {
     const accessToken = this.jwtService.sign(payload, { expiresIn: '15m' });
     const refreshToken = this.jwtService.sign(payload, { expiresIn: '7d' });
     
     // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å refresh token –≤ Redis —Å TTL 7 –¥–Ω–µ–π
     await this.redis.set(`refresh:${userId}`, refreshToken, 'EX', 604800);
     
     return { accessToken, refreshToken };
   }
   ```

2. **–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤:**
   - ‚úÖ Access token: httpOnly cookie (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
   - ‚úÖ Refresh token: httpOnly cookie (–Ω–µ localStorage)
   - ‚ùå –£–±—Ä–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ localStorage –Ω–∞ frontend

3. **Token blacklist:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å blacklist –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–∞
   - TTL blacklist = –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ access token

4. **Scope-based –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**
   ```typescript
   @RequireScopes('transactions:read', 'vehicles:write')
   async getTransactions() { }
   ```

5. **Rate limiting –¥–ª—è auth:**
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è `/login` (5 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
   - –û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è `/refresh` (10 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É)
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –ø–æ—Å–ª–µ 10 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫

---

### 4. WebSocket –∏ realtime-–ª–æ–≥–∏–∫–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** üî¥ **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç**

WebSocket –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç–µ. –í `TODO.md` –µ—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –Ω–æ –∫–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç WebSocket —Å–µ—Ä–≤–µ—Ä–∞
- ‚ùå –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ polling (HTTP –∑–∞–ø—Ä–æ—Å—ã)
- ‚ùå –ù–µ—Ç realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ (progress)
- ‚ùå –ù–µ—Ç realtime –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚ùå Frontend –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Socket.io client (—Ö–æ—Ç—è —É–∫–∞–∑–∞–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WebSocket —Å–µ—Ä–≤–∏—Å –Ω–∞ NestJS:**
   ```typescript
   // realtime-service/src/realtime.gateway.ts
   @WebSocketGateway({
     cors: { origin: '*' },
     namespace: '/realtime'
   })
   export class RealtimeGateway {
     @WebSocketServer()
     server: Server;
     
     @SubscribeMessage('subscribe:notifications')
     handleSubscribe(client: Socket, userId: string) {
       client.join(`user:${userId}`);
     }
   }
   ```

2. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis Pub/Sub –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–µ—Ä–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
   - –ü–æ–¥–∫–ª—é—á–∏—Ç—å Socket.io adapter –¥–ª—è Redis
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å sticky sessions —á–µ—Ä–µ–∑ Redis

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ reconnect:**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å exponential backoff
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ reconnect
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ Redis

4. **Realtime —Å–æ–±—ã—Ç–∏—è:**
   - `notification:new` - –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - `upload:progress` - –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
   - `transaction:created` - –Ω–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
   - `card:updated` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã

5. **Fallback –Ω–∞ long polling:**
   - –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ WebSocket –ø–æ–¥–¥–µ—Ä–∂–∫–∏
   - Endpoint `/api/v1/realtime/poll` —Å —Ç–∞–π–º–∞—É—Ç–æ–º 30 —Å–µ–∫—É–Ω–¥

---

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ (Platform Adapters)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π**

–ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `backend/app/services/api_provider_service.py`:
- `PetrolPlusAdapter` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ü–ü–† API
- `WebAdapter` - –≤–µ–±-—Å–µ—Ä–≤–∏—Å—ã
- `RnCardAdapter` - –†–ù-–ö–∞—Ä—Ç—ã
- `GPNAdapter` - –ì–ü–ù

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `tenacity` –¥–ª—è retry —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (XML, JSON, JWT)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è Retry —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ (—Ç–æ–ª—å–∫–æ –≤ `RnCardAdapter`)
- ‚ö†Ô∏è –ù–µ—Ç Circuit Breaker –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤
- ‚ö†Ô∏è –ù–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º API (versioning)
- ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–Ω–µ—à–Ω–∏—Ö API
- ‚ö†Ô∏è –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –≤–Ω–µ—à–Ω–∏—Ö API

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å retry —Å—Ç—Ä–∞—Ç–µ–≥–∏—é:**
   ```typescript
   // platform-adapters/src/common/retry-strategy.ts
   @Injectable()
   export class RetryStrategy {
     async execute<T>(
       fn: () => Promise<T>,
       options: RetryOptions = {}
     ): Promise<T> {
       return retry(
         stopAfterAttempt(options.maxAttempts || 3),
         waitExponential({ multiplier: 1, min: 2, max: 10 }),
         retryIfResult(isEmpty),
         retryIfExceptionType(HttpException)
       )(fn);
     }
   }
   ```

2. **–í–Ω–µ–¥—Ä–∏—Ç—å Circuit Breaker:**
   ```typescript
   // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å @nestjs/circuit-breaker
   @CircuitBreaker({ timeout: 5000, errorThresholdPercentage: 50 })
   async fetchExternalData() { }
   ```

3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º API:**
   - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ (v1, v2)
   - Feature flags –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π
   - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π API

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–Ω–µ—à–Ω–∏—Ö API:**
   - Health checks –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
   - –ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (uptime, response time)
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö API

5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤:**
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–ø—Ä–∞–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–∞—Ä—Ç—ã, –¥–æ–≥–æ–≤–æ—Ä—ã)
   - TTL –∫—ç—à–∞: 5-15 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö
   - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

---

### 6. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ (Device Config)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å. –ï—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è—Ö, –Ω–æ –Ω–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç Device Config Service
- ‚ùå –ù–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- ‚ùå –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç–∫–∞—Ç–æ–≤ (rollback)
- ‚ùå –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–°–æ–∑–¥–∞—Ç—å Device Config Service:**
   ```typescript
   // device-config/src/device-config.service.ts
   @Injectable()
   export class DeviceConfigService {
     async createConfig(deviceId: string, config: ConfigDto) {
       // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
       const validated = await this.validateConfig(config);
       
       // –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
       const version = await this.getNextVersion(deviceId);
       
       // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å –≤–µ—Ä—Å–∏–µ–π
       return this.configRepository.save({
         deviceId,
         version,
         config: validated,
         status: 'pending'
       });
     }
   }
   ```

2. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - Semantic versioning (major.minor.patch)
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤–µ—Ä—Å–∏–π –≤ –ë–î
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ diff –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏

3. **Rollback –º–µ—Ö–∞–Ω–∏–∑–º:**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
   - –†—É—á–Ω–æ–π rollback —á–µ—Ä–µ–∑ API

4. **–í–∞–ª–∏–¥–∞—Ü–∏—è:**
   - JSON Schema –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   - –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ staging –ø–µ—Ä–µ–¥ production

---

### 7. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—á–µ—Ä–µ–¥–∏ (Redis)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (`backend/app/services/cache_service.py`) –∏ rate limiting (`backend/app/middleware/rate_limit.py`).

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ Singleton pattern –¥–ª—è CacheService
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TTL –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
- ‚úÖ –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É (`delete_pattern`)
- ‚úÖ –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@cached` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö Redis DB –¥–ª—è –∫—ç—à–∞ –∏ rate limiting

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Redis –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π (—Ç–æ–ª—å–∫–æ –∫—ç—à)
- ‚ö†Ô∏è –ù–µ—Ç –∏–∑–æ–ª—è—Ü–∏–∏ –∫–ª—é—á–µ–π –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º (dev/prod)
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pickle –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- ‚ö†Ô∏è –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ Redis

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è –æ—á–µ—Ä–µ–¥–µ–π:**
   ```typescript
   // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Bull/BullMQ –¥–ª—è job queues
   @Injectable()
   export class QueueService {
     private readonly uploadQueue = new Queue('upload', {
       connection: { host: 'redis', port: 6379 }
     });
     
     async addUploadJob(file: File) {
       return this.uploadQueue.add('process-upload', { file });
     }
   }
   ```

2. **–ò–∑–æ–ª—è—Ü–∏—è –∫–ª—é—á–µ–π:**
   ```python
   # –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å –æ–∫—Ä—É–∂–µ–Ω–∏—è
   def _make_key(self, key: str, prefix: str = "gsm") -> str:
       env = os.getenv("ENVIRONMENT", "dev")
       return f"{env}:{prefix}:{key}"
   ```

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JSON –≤–º–µ—Å—Ç–æ pickle
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å msgpack –¥–ª—è –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Redis:**
   - –ú–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
   - –ú–µ—Ç—Ä–∏–∫–∏ hit/miss rate
   - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –ø–∞–º—è—Ç–∏

5. **–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis Sets –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ WebSocket
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis Sorted Sets –¥–ª—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis Streams –¥–ª—è event sourcing

---

### 8. DevOps –∏ observability

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ**

–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Prometheus –º–µ—Ç—Ä–∏–∫–∏ (`backend/app/middleware/prometheus_metrics.py`), –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`backend/app/logger.py`), Docker Compose.

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ Prometheus –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å extra –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ Health checks endpoints (`/health`, `/health/live`, `/health/ready`)
- ‚úÖ Docker Compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ Graceful shutdown –≤ `lifespan` —Ñ—É–Ω–∫—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ù–µ—Ç distributed tracing (OpenTelemetry/Jaeger)
- ‚ö†Ô∏è –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (ELK/Loki)
- ‚ö†Ô∏è –ù–µ—Ç –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞ (Alertmanager)
- ‚ö†Ô∏è Health checks –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Redis, –≤–Ω–µ—à–Ω–∏–µ API)
- ‚ö†Ô∏è –ù–µ—Ç –º–µ—Ç—Ä–∏–∫ –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (KPI)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **Distributed tracing:**
   ```typescript
   // –í–Ω–µ–¥—Ä–∏—Ç—å OpenTelemetry
   import { TraceService } from '@nestjs/observability';
   
   @Injectable()
   export class TransactionService {
     constructor(private trace: TraceService) {}
     
     async createTransaction(data: CreateTransactionDto) {
       const span = this.trace.startSpan('create_transaction');
       // ...
       span.end();
     }
   }
   ```

2. **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Loki –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –ª–æ–≥–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å correlation ID –¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ

3. **–ê–ª–µ—Ä—Ç–∏–Ω–≥:**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Alertmanager –¥–ª—è Prometheus
   - –ê–ª–µ—Ä—Ç—ã –Ω–∞ –æ—à–∏–±–∫–∏ 5xx, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Slack/Telegram/Email

4. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ health checks:**
   ```typescript
   @Get('/health/ready')
   async readiness() {
     const checks = {
       database: await this.checkDatabase(),
       redis: await this.checkRedis(),
       externalApis: await this.checkExternalApis()
     };
     
     return {
       status: Object.values(checks).every(c => c.healthy) ? 'ready' : 'not_ready',
       checks
     };
   }
   ```

5. **–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏:**
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –¥–µ–Ω—å
   - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∑–∞–≥—Ä—É–∑–æ–∫ –≤ —É—Å–ø–µ—à–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

---

## üß™ –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

### Frontend —Ç–µ—Å—Ç—ã

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚ö†Ô∏è **–ß–∞—Å—Ç–∏—á–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**

**–ù–∞–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤:**
- ‚úÖ 9 unit-—Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Ö—É–∫–æ–≤ (`src/hooks/__tests__/`)
- ‚úÖ 2 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã—Ö —Ç–µ—Å—Ç–∞ (`src/components/__tests__/`)
- ‚úÖ 2 —Ç–µ—Å—Ç–∞ –¥–ª—è —É—Ç–∏–ª–∏—Ç (`src/utils/__tests__/`)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (169 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ç–æ–ª—å–∫–æ 2 —Ç–µ—Å—Ç–∞)
- ‚ùå –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–ª—è React Query
- ‚ùå –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚ùå –ù–µ—Ç E2E —Ç–µ—Å—Ç–æ–≤ –¥–ª—è frontend
- ‚ùå –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è —Ñ–æ—Ä–º (React Hook Form)
- ‚ùå –ü–æ—Ä–æ–≥ –ø–æ–∫—Ä—ã—Ç–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 60%, –Ω–æ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–£–≤–µ–ª–∏—á–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
   ```javascript
   // src/components/__tests__/TransactionsList.test.jsx
   import { render, screen, waitFor } from '@testing-library/react';
   import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
   import TransactionsList from '../TransactionsList';
   
   describe('TransactionsList', () => {
     it('–¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π', async () => {
       const queryClient = new QueryClient();
       render(
         <QueryClientProvider client={queryClient}>
           <TransactionsList />
         </QueryClientProvider>
       );
       
       await waitFor(() => {
         expect(screen.getByText('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏')).toBeInTheDocument();
       });
     });
   });
   ```

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è React Query:**
   - –¢–µ—Å—Ç—ã –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –¢–µ—Å—Ç—ã –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫—ç—à–∞
   - –¢–µ—Å—Ç—ã –¥–ª—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

3. **–¢–µ—Å—Ç—ã –¥–ª—è —Ñ–æ—Ä–º:**
   ```javascript
   // –¢–µ—Å—Ç—ã –¥–ª—è React Hook Form
   import { renderHook, act } from '@testing-library/react';
   import { useForm } from 'react-hook-form';
   
   it('–¥–æ–ª–∂–µ–Ω –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', () => {
     const { result } = renderHook(() => useForm());
     // ...
   });
   ```

4. **E2E —Ç–µ—Å—Ç—ã:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Playwright –∏–ª–∏ Cypress
   - –¢–µ—Å—Ç—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)

5. **–ü–æ—Ä–æ–≥ –ø–æ–∫—Ä—ã—Ç–∏—è:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º—É–º 80% –¥–ª—è core-–ª–æ–≥–∏–∫–∏
   - 60% –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ UI
   - 90% –¥–ª—è —É—Ç–∏–ª–∏—Ç –∏ —Ö—É–∫–æ–≤

---

### Backend —Ç–µ—Å—Ç—ã

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ **–•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π**

**–ù–∞–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤:**
- ‚úÖ 26 —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ `backend/tests/`
- ‚úÖ E2E —Ç–µ—Å—Ç—ã –≤ `backend/tests/e2e/`
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è auth, transactions, vehicles, providers –∏ –¥—Ä.

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –¢–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π (auth, transactions)
- ‚úÖ E2E —Ç–µ—Å—Ç—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ pytest fixtures

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è WebSocket (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Redis
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Circuit Breaker
- ‚ö†Ô∏è –ù–µ—Ç –º–æ–∫–æ–≤ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API –∞–¥–∞–ø—Ç–µ—Ä–æ–≤
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è rate limiting
- ‚ö†Ô∏è –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤ –¥–ª—è Prometheus –º–µ—Ç—Ä–∏–∫

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–¢–µ—Å—Ç—ã –¥–ª—è Redis –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**
   ```python
   # backend/tests/test_cache_service.py
   def test_cache_set_get():
       cache = CacheService.get_instance()
       cache.set("test_key", {"data": "value"}, ttl=60)
       result = cache.get("test_key")
       assert result == {"data": "value"}
   ```

2. **–ú–æ–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API:**
   ```python
   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pytest-httpx –∏–ª–∏ responses
   @pytest.fixture
   def mock_provider_api(httpx_mock):
       httpx_mock.add_response(
           method="GET",
           url="https://api.provider.com/cards",
           json={"cards": []}
       )
   ```

3. **–¢–µ—Å—Ç—ã –¥–ª—è rate limiting:**
   ```python
   def test_rate_limit_exceeded(client):
       # –û—Ç–ø—Ä–∞–≤–∏—Ç—å 100 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ —Å–µ–∫—É–Ω–¥—É
       for _ in range(100):
           response = client.get("/api/v1/transactions")
       assert response.status_code == 429
   ```

4. **–¢–µ—Å—Ç—ã –¥–ª—è WebSocket (–ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏):**
   ```python
   async def test_websocket_notification(client):
       async with client.websocket_connect("/ws/notifications") as ws:
           # –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
           # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket
   ```

5. **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π:**
   - ‚úÖ Auth: 90%+ (—É–∂–µ —Ö–æ—Ä–æ—à–æ –ø–æ–∫—Ä—ã—Ç–æ)
   - ‚ö†Ô∏è Transactions: —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 85%+
   - ‚ö†Ô∏è Notifications: –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
   - ‚ö†Ô∏è Platform Adapters: –¥–æ–±–∞–≤–∏—Ç—å –º–æ–∫–∏ –∏ —Ç–µ—Å—Ç—ã

---

### –û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚ö†Ô∏è **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ**

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤ CI/CD
- ‚ùå –ù–µ—Ç –æ—Ç—á—ë—Ç–æ–≤ –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ –≤ PR
- ‚ùå –ù–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–º—É –ø–æ–∫—Ä—ã—Ç–∏—é –¥–ª—è merge

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   ```yaml
   # .github/workflows/test.yml
   - name: Run tests
     run: |
       pytest --cov=app --cov-report=xml
       npm run test:coverage
   
   - name: Coverage check
     run: |
       coverage report --fail-under=80
   ```

2. **–ü–æ—Ä–æ–≥–∏ –ø–æ–∫—Ä—ã—Ç–∏—è:**
   - Backend core logic: ‚â•85%
   - Backend services: ‚â•80%
   - Frontend hooks/utils: ‚â•90%
   - Frontend components: ‚â•70%

3. **–û—Ç—á—ë—Ç—ã –≤ PR:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Codecov –∏–ª–∏ Coveralls
   - –ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –≤ PR
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å merge –ø—Ä–∏ —Å–Ω–∏–∂–µ–Ω–∏–∏ –ø–æ–∫—Ä—ã—Ç–∏—è

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–±–ª–æ–∫–∏—Ä—É—é—Ç production)

1. **–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –º–æ–Ω–æ–ª–∏—Ç–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã**
   - –û—Ü–µ–Ω–∫–∞: 4-6 –Ω–µ–¥–µ–ª—å
   - –í—ã–¥–µ–ª–∏—Ç—å Auth Service, Notifications Service, Platform Adapters
   - –í–Ω–µ–¥—Ä–∏—Ç—å API Gateway –Ω–∞ NestJS

2. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è WebSocket –¥–ª—è realtime**
   - –û—Ü–µ–Ω–∫–∞: 1-2 –Ω–µ–¥–µ–ª–∏
   - NestJS Gateway + Socket.io
   - Redis Pub/Sub –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

3. **–£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
   - –û—Ü–µ–Ω–∫–∞: 1 –Ω–µ–¥–µ–ª—è
   - Refresh token –º–µ—Ö–∞–Ω–∏–∑–º
   - Token blacklist –≤ Redis
   - –£–±—Ä–∞—Ç—å localStorage –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤

4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**
   - –û—Ü–µ–Ω–∫–∞: 2-3 –Ω–µ–¥–µ–ª–∏
   - –î–æ–≤–µ—Å—Ç–∏ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ 80% –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π
   - –î–æ–±–∞–≤–∏—Ç—å E2E —Ç–µ—Å—Ç—ã

---

### üü† –í—ã—Å–æ–∫–∏–µ (—Ä–∏—Å–∫ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏)

1. **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ Circuit Breaker –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API**
   - –û—Ü–µ–Ω–∫–∞: 1 –Ω–µ–¥–µ–ª—è
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã—Ö —Å–±–æ–µ–≤
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API

2. **–£–ª—É—á—à–µ–Ω–∏–µ observability**
   - –û—Ü–µ–Ω–∫–∞: 1-2 –Ω–µ–¥–µ–ª–∏
   - Distributed tracing (OpenTelemetry)
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Loki)
   - –ê–ª–µ—Ä—Ç–∏–Ω–≥ (Alertmanager)

3. **Database per service**
   - –û—Ü–µ–Ω–∫–∞: 2-3 –Ω–µ–¥–µ–ª–∏
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ë–î –ø–æ —Å–µ—Ä–≤–∏—Å–∞–º
   - Event-driven —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

4. **–£–ª—É—á—à–µ–Ω–∏–µ health checks**
   - –û—Ü–µ–Ω–∫–∞: 3-5 –¥–Ω–µ–π
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Redis, –≤–Ω–µ—à–Ω–∏–µ API)
   - –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã

---

### üü° –°—Ä–µ–¥–Ω–∏–µ (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥)

1. **–ú–∏–≥—Ä–∞—Ü–∏—è frontend –Ω–∞ TypeScript**
   - –û—Ü–µ–Ω–∫–∞: 2-3 –Ω–µ–¥–µ–ª–∏
   - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –¢–∏–ø–∏–∑–∞—Ü–∏—è API responses

2. **–£–ª—É—á—à–µ–Ω–∏–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**
   - –û—Ü–µ–Ω–∫–∞: 1 –Ω–µ–¥–µ–ª—è
   - JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤–º–µ—Å—Ç–æ pickle
   - –ò–∑–æ–ª—è—Ü–∏—è –∫–ª—é—á–µ–π –ø–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è–º

3. **Device Config Service**
   - –û—Ü–µ–Ω–∫–∞: 2 –Ω–µ–¥–µ–ª–∏
   - –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   - Rollback –º–µ—Ö–∞–Ω–∏–∑–º

4. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏ –¥–æ 80%+**
   - –û—Ü–µ–Ω–∫–∞: 3-4 –Ω–µ–¥–µ–ª–∏
   - –¢–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

---

### üü¢ –ù–∏–∑–∫–∏–µ (—É–¥–æ–±—Å—Ç–≤–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

1. **–£–ª—É—á—à–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API**
   - OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è
   - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è bundle size**
   - Code splitting
   - Tree shaking
   - Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

3. **–£–ª—É—á—à–µ–Ω–∏–µ DX (Developer Experience)**
   - Hot reload –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
   - –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å Docker Compose
   - –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ KPI

### –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏

- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:** ~40-50% (–æ—Ü–µ–Ω–∫–∞)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:** 0 (–º–æ–Ω–æ–ª–∏—Ç)
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API:** –ù–µ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è
- **Uptime –≤–Ω–µ—à–Ω–∏—Ö API:** –ù–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è

### –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏:** ‚â•80% –¥–ª—è core logic
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤:** 8-10 —Å–µ—Ä–≤–∏—Å–æ–≤
- **–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API:** p95 < 200ms
- **Uptime –≤–Ω–µ—à–Ω–∏—Ö API:** ‚â•99.5%
- **WebSocket reconnect time:** < 2 —Å–µ–∫—É–Ω–¥—ã

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –±–∞–∑—É (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞, –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥), –Ω–æ **–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–∞ NestJS/TypeScript**. –î–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è production-ready —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. **–ö—Ä–∏—Ç–∏—á–Ω–æ:** –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –º–æ–Ω–æ–ª–∏—Ç–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
2. **–ö—Ä–∏—Ç–∏—á–Ω–æ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è WebSocket –¥–ª—è realtime
3. **–ö—Ä–∏—Ç–∏—á–Ω–æ:** –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏
4. **–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í–Ω–µ–¥—Ä–µ–Ω–∏–µ Circuit Breaker, —É–ª—É—á—à–µ–Ω–∏–µ observability

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É:** 3-4 –º–µ—Å—è—Ü–∞ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á, 6-8 –º–µ—Å—è—Ü–µ–≤ –¥–ª—è –ø–æ–ª–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É.

---

**–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:** –°–∏—Å—Ç–µ–º–Ω—ã–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä  
**–î–∞—Ç–∞:** 2024

