# ‚úÖ –£–ª—É—á—à–µ–Ω–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–î–∞—Ç–∞:** 2025-12-26  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ –Ω–∞ –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è**

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

**–ë—ã–ª–æ:**
- –®–∏—Ñ—Ä–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ `password` –≤ `connection_settings`

**–°—Ç–∞–ª–æ:**
- –®–∏—Ñ—Ä—É—é—Ç—Å—è –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:
  - `password` - –ø–∞—Ä–æ–ª–∏ –¥–ª—è Firebird, –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤
  - `api_token` - —Ç–æ–∫–µ–Ω—ã API –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  - `api_key` - –∫–ª—é—á–∏ API –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  - `api_secret` - —Å–µ–∫—Ä–µ—Ç—ã API –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  - `xml_api_key` - –∫–ª—é—á–∏ XML API
  - `xml_api_signature` - –ø–æ–¥–ø–∏—Å–∏ XML API
  - `xml_api_salt` - —Å–æ–ª–∏ –¥–ª—è XML API
  - `certificate` - —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è XML API
  - `secret` - –æ–±—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã
  - `token` - –æ–±—â–∏–µ —Ç–æ–∫–µ–Ω—ã

---

## üîß –ò–∑–º–µ–Ω–µ–Ω–∏—è

### 1. `backend/app/utils/encryption.py`

#### `encrypt_connection_settings()`
- **–ë—ã–ª–æ:** –®–∏—Ñ—Ä–æ–≤–∞–ª —Ç–æ–ª—å–∫–æ `password`
- **–°—Ç–∞–ª–æ:** –®–∏—Ñ—Ä—É–µ—Ç –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ù–µ —à–∏—Ñ—Ä—É–µ—Ç —É–∂–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ø—Ä–µ—Ñ–∏–∫—Å `encrypted:`)

#### `decrypt_connection_settings()`
- **–ë—ã–ª–æ:** –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–ª —Ç–æ–ª—å–∫–æ `password`
- **–°—Ç–∞–ª–æ:** –†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞–∫ –µ—Å—Ç—å

### 2. `backend/app/schemas.py`

#### `ProviderTemplateResponse`
- **–ë—ã–ª–æ:** –°–∫—Ä—ã–≤–∞–ª —Ç–æ–ª—å–∫–æ `password` –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
- **–°—Ç–∞–ª–æ:** –°–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ API –æ—Ç–≤–µ—Ç–∞—Ö

### 3. `backend/tests/test_encryption.py` (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)

- **–°–æ–∑–¥–∞–Ω–æ:** 12 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- **–ü–æ–∫—Ä—ã—Ç–∏–µ:**
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–∞—Ä–æ–ª–µ–π
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
  - –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
  - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ-—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ú–µ—Å—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è `connection_settings`:

1. ‚úÖ `templates.py` - `update_template()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `serialize_template_json()` ‚Üí —à–∏—Ñ—Ä—É–µ—Ç
2. ‚úÖ `templates.py` - `test_api_connection_direct()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `serialize_template_json()` ‚Üí —à–∏—Ñ—Ä—É–µ—Ç
3. ‚úÖ `templates.py` - `get_api_fields_direct()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `serialize_template_json()` ‚Üí —à–∏—Ñ—Ä—É–µ—Ç

### –ú–µ—Å—Ç–∞ —á—Ç–µ–Ω–∏—è `connection_settings`:

1. ‚úÖ `templates.py` - `test_firebird_connection()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `parse_template_json()` ‚Üí —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç
2. ‚úÖ `templates.py` - `get_firebird_table_columns()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `parse_template_json()` ‚Üí —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç
3. ‚úÖ `schemas.py` - `ProviderTemplateResponse` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `decrypt_connection_settings()` ‚Üí —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç –∏ —Å–∫—Ä—ã–≤–∞–µ—Ç

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ —à–∏—Ñ—Ä—É–µ—Ç—Å—è:
- ‚úÖ –ü–∞—Ä–æ–ª–∏ Firebird
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ API —Ç–æ–∫–µ–Ω—ã
- ‚úÖ API –∫–ª—é—á–∏
- ‚úÖ API —Å–µ–∫—Ä–µ—Ç—ã
- ‚úÖ XML API –∫–ª—é—á–∏
- ‚úÖ XML API –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ XML API —Å–æ–ª–∏
- ‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

### –ß—Ç–æ –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ API:
- ‚úÖ –í—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —Å–∫—Ä—ã—Ç—ã –≤ `ProviderTemplateResponse`
- ‚úÖ –í –ª–æ–≥–∞—Ö –ø–∞—Ä–æ–ª–∏ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è (`***`)

### –ê–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:
- ‚úÖ **Fernet** (—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –±–∞–∑–µ AES-128 –≤ —Ä–µ–∂–∏–º–µ CBC)
- ‚úÖ **PBKDF2** —Å 100,000 –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞
- ‚úÖ **SHA256** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–ª–∏
- ‚úÖ –ü—Ä–µ—Ñ–∏–∫—Å `encrypted:` –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

---

## üìà –£–ª—É—á—à–µ–Ω–∏—è

1. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ:**
   - –¢–µ–ø–µ—Ä—å —à–∏—Ñ—Ä—É—é—Ç—Å—è –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è, –Ω–µ —Ç–æ–ª—å–∫–æ –ø–∞—Ä–æ–ª–∏
   - –ó–∞—â–∏—Ç–∞ API —Ç–æ–∫–µ–Ω–æ–≤ –∏ –∫–ª—é—á–µ–π

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API:**
   - –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö API
   - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π

4. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
   - –°—Ç–∞—Ä—ã–µ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è - **–ó–ê–í–ï–†–®–ï–ù–û**
2. ‚úÖ –°–∫—Ä—ã—Ç–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ API - **–ó–ê–í–ï–†–®–ï–ù–û**
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ - **–ó–ê–í–ï–†–®–ï–ù–û**
4. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
5. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-12-26  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–æ –∏ —É–ª—É—á—à–µ–Ω–æ

